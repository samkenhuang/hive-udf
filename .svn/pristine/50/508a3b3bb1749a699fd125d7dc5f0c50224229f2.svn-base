package com.weiboyi.bi.hive.udf;

import org.apache.hadoop.hive.ql.exec.Description;
import org.apache.hadoop.hive.ql.exec.UDF;
import org.apache.hadoop.io.BytesWritable;
import org.apache.hadoop.io.IntWritable;

import java.math.BigInteger;

/**
 * Created by huangxin on 2018/11/22
 */
@Description(name = "HexToBigInteger", value = "_FUNC_(hex_str) - convert binary to BigInteger")
public class BinaryToBigInteger extends UDF {
    public IntWritable evaluate(BytesWritable b) throws Exception {
        BigInteger num = new BigInteger(b.getBytes());
        return new IntWritable(num.intValue());
    }

    private static byte hexToByte(String inHex) {
        return (byte)Integer.parseInt(inHex,16);
    }
}
